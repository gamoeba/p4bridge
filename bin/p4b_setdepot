#!/bin/bash

P4BRIDGEDIR=".p4bridge"
P4BRIDGEROOTDIR=$P4BRIDGEDIR"/root"

function upsearch () {
    test / == "$PWD" && return || test -e "$1" && return || cd .. && upsearch "$1"
}


read_properties()
{
  file="$1"
  while IFS="=" read -r key value; do
    case "$key" in
      '#'*) ;;
      *)
        eval "export $key=\"$value\""
    esac
  done < "$file"
}

upsearch $P4BRIDGEDIR

read_properties "$P4BRIDGEDIR/config"
