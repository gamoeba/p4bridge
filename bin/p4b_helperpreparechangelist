#!/bin/bash

. p4b_setdepot
if git cat-file -e $1 2> /dev/null 
then 

	git cherry-pick $1
	rc=$?
	if [[ $rc != 0 ]]
	then
		echo problem with cherry-pick -- correct first
		exit $rc
	fi 
	git diff-tree --no-commit-id -r $1 | awk -v dd=$DEPOTDIR '{print $5" "dd"/"$6 }' | 
					sed -e 's/^M/p4 edit/g' -e 's/^A/p4 add/g' -e 's/^D/p4 delete/g' | 
								while read -r line 
								do 
									${line} 
								done
else
	echo "commit $1 not present in $DEPOTDIR"
fi
