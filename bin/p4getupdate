#!/bin/bash
. p4setdepot
echo "fetching changelist $DEPOTDIR@$1"
p4 sync $DEPOTDIR"/..."@$1
git add --all
AUTHOR=`p4changecommitter $1`
DATE=`p4changedate $1`
DESC=`p4changedesc $1 | changefilter`
git commit -m "$DESC" --author="$AUTHOR < $AUTHOR@unknown.com >" --date="$DATE"
if [ $? -eq 0 ]
then
setlastp4change $1
else
echo "no changes, changelist skipped"
fi
